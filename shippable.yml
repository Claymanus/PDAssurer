build_image: shippableimages/ubuntu1404_python
env:
  global: 
    - NSS_DEFAULT_DB_TYPE="sql"
    - I_DONT_MIND_IF_MY_CHROME_PKI_DATABASE_GETS_DELETED=true
before_install:
- id
- ./tools/setupdoc
- cp /etc/hosts /tmp
- echo "127.0.0.1 local.sso.edemokraciagep.org" >>/tmp/hosts
- cp /tmp/hosts /etc/hosts
- apt-get update
- apt-get -y install python make python-pip firefox openjdk-7-jre curl docbook-xsl apache2 libapache2-mod-wsgi swig chromium-browser chromium-chromedriver libnss3-tools xvfb python-dev
- export DISPLAY=:99.0
- /sbin/start-stop-daemon --start --quiet --pidfile /tmp/cucumber_xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -ac -screen 0 1024x768x24
- cp src/end2endtest/certs.json /etc/chromium-browser/policies/managed/
- pip install -r requirements.txt
- pip show -f SQLAlchemy
script:
- make checkall
- ./tools/commitdocs
